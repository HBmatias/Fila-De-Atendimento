function getFormData(form){let data={};return form.find("input, select, textarea").each((function(index,element){let input=$(element),value=input.val()||null;if(void 0!==input.attr("required")&&(""==value||void 0===value||null==value)){let label,err=`O campo "${form.find(`label[for="${input.attr("id")}"]`).text().replace(/:/g,"")}" é obrigatório!`;throw alert(err),new Error(err)}"cpf"==input.attr("name")&&(value=value.replace(/\D/g,"")),data[input.attr("name")]=value})),data}function getAge(birth){let today=new Date,age=today.getFullYear()-birth.getFullYear(),m=today.getMonth()-birth.getMonth();return(m<0||0===m&&today.getDate()<birth.getDate())&&age--,age}function gerar(){let nomes=["Diego","Gabriel","Lucas"],lista=document.getElementById("lista");for(var i=0;i<nomes.length;i++){let item=document.createElement("li");item.appendChild(document.createTextNode(nomes[i])),lista.appendChild(item)}}function PriorityRules(patient,data){const pr=this;pr.birth=new Date(patient.birthday),pr.age=getAge(pr.birth),pr.init=function(){pr.birthRule=pr.getBirthRule(),pr.healthRule=pr.getHealthRule(),pr.history=pr.getHistory(),pr.symptoms=toInt(pr.symptoms),pr.media=(2*pr.birthRule+5*pr.healthRule+3*pr.history+4*pr.symptoms)/4,pr.media>=5&&(pr.priority=1),pr.media>=3&&pr.media<5&&(pr.priority=2),pr.media<3&&(pr.priority=3)},pr.getBirthRule=function(){return pr.age>=60||pr.age<=2?pr.age<60&&"N"==!data.comorbidity?4:3:pr.age<60&&"S"==data.comorbidity?2:1},pr.getHealthRule=function(){let weight=$('[id="health"]').data("weight"),health=toInt(data.health)*toInt(weight)/100;return health>=1?3:health>=.5?2:1},pr.getHistory=function(){let weight=$('[id="family"]').data("weight"),family=toInt(data.family)*toInt(weight);return null!==data.socioeconomic&&(family*=toInt(data.socioeconomic)),null!==data.accessToCare&&(family*=toInt(data.accessToCare)),family/=100,family>=1?3:family>=.5?2:1},pr.init()}function toInt(number){return parseInt(toDecimal("0"+number,0))}function toDecimal(number,decimais){return decimais>0?toFloat(number).toFixed(decimais||2).replace(".",","):parseInt(toFloat(number).toFixed(0))+""}function toFloat(number){return(number=("0"+number).match(/(\d|,|\.)/g).join("")).indexOf(",")>=0?parseFloat((number+"").replace(/\./g,"").replace(",",".")):parseFloat(number)}$((function(){window.patients=new Patient,window.priority=new PriorityList,console.log(window.patients,window.priority),$("#cpf").mask("000.000.000-00",{reverse:!0}),$(".listAccess").on("click",(function(event){event.preventDefault();let form,data=getFormData($("#listAccess"));if(11!==data.cpf.length||""==data.cpf||void 0===data.cpf)return alert("CPF inválido!"),!1;const patient=window.patients.getRowByCPF(data.cpf);if(void 0===patient.name)return alert("Paciente não encontrado!"),!1;const priority=new PriorityRules(patient,data);window.priority.addRow({patient_id:patient.id,priority:priority.priority,date:Date(),health:priority.health,family:priority.history,symptoms:priority.symptoms,socioeconomic:data.socioeconomic,accessToCare:data.accessToCare}),console.log(window.priority)}))}));
//# sourceMappingURL=script.min.js.map